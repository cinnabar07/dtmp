{"version":3,"file":"maxVertexBufferArrayStride.spec.js","names":["roundDown","kMaximumLimitBaseParams","makeLimitTestGroup","getPipelineDescriptor","device","testValue","code","module","createShaderModule","layout","vertex","entryPoint","buffers","arrayStride","attributes","shaderLocation","offset","format","depthStencil","depthWriteEnabled","depthCompare","kMinAttributeStride","getDeviceLimitToRequest","limitValueTest","defaultLimit","maximumLimit","Math","min","floor","getTestValue","testValueName","requestedLimit","getDeviceLimitToRequestAndValueToTest","limit","g","description","test","desc","params","combine","fn","t","limitTest","async","adapterLimit","testDeviceWithSpecificLimits","shouldError","pipelineDescriptor","testCreateRenderPipeline","expect"],"sources":["../../../../../../src/webgpu/api/validation/capability_checks/limits/maxVertexBufferArrayStride.spec.ts"],"sourcesContent":["/**\n* AUTO-GENERATED - DO NOT EDIT. Source: https://github.com/gpuweb/cts\n**/import { roundDown } from '../../../../util/math.js';import {\n  kMaximumLimitBaseParams,\n  makeLimitTestGroup } from\n\n\n'./limit_utils.js';\n\nfunction getPipelineDescriptor(device, testValue) {\n  const code = `\n  @vertex fn vs(@location(0) v: f32) -> @builtin(position) vec4f {\n    return vec4f(v);\n  }\n  `;\n  const module = device.createShaderModule({ code });\n  return {\n    layout: 'auto',\n    vertex: {\n      module,\n      entryPoint: 'vs',\n      buffers: [\n      {\n        arrayStride: testValue,\n        attributes: [\n        {\n          shaderLocation: 0,\n          offset: 0,\n          format: 'float32'\n        }]\n\n      }]\n\n    },\n    depthStencil: { format: 'depth32float', depthWriteEnabled: true, depthCompare: 'always' }\n  };\n}\n\nconst kMinAttributeStride = 4;\n\nfunction getDeviceLimitToRequest(\nlimitValueTest,\ndefaultLimit,\nmaximumLimit)\n{\n  switch (limitValueTest) {\n    case 'atDefault':\n      return defaultLimit;\n    case 'underDefault':\n      return defaultLimit - kMinAttributeStride;\n    case 'betweenDefaultAndMaximum':\n      return Math.min(\n        defaultLimit,\n        roundDown(Math.floor((defaultLimit + maximumLimit) / 2), kMinAttributeStride)\n      );\n    case 'atMaximum':\n      return maximumLimit;\n    case 'overMaximum':\n      return maximumLimit + kMinAttributeStride;\n  }\n}\n\nfunction getTestValue(testValueName, requestedLimit) {\n  switch (testValueName) {\n    case 'atLimit':\n      return requestedLimit;\n    case 'overLimit':\n      return requestedLimit + kMinAttributeStride;\n  }\n}\n\nfunction getDeviceLimitToRequestAndValueToTest(\nlimitValueTest,\ntestValueName,\ndefaultLimit,\nmaximumLimit)\n{\n  const requestedLimit = getDeviceLimitToRequest(limitValueTest, defaultLimit, maximumLimit);\n  return {\n    requestedLimit,\n    testValue: getTestValue(testValueName, requestedLimit)\n  };\n}\n\n/*\nNote: We need to request +4 (vs the default +1) because otherwise we may trigger the wrong validation\nof the arrayStride not being a multiple of 4\n*/\nconst limit = 'maxVertexBufferArrayStride';\nexport const { g, description } = makeLimitTestGroup(limit);\n\ng.test('createRenderPipeline,at_over').\ndesc(`Test using createRenderPipeline(Async) at and over ${limit} limit`).\nparams(kMaximumLimitBaseParams.combine('async', [false, true])).\nfn(async (t) => {\n  const { limitTest, testValueName, async } = t.params;\n  const { defaultLimit, adapterLimit: maximumLimit } = t;\n  const { requestedLimit, testValue } = getDeviceLimitToRequestAndValueToTest(\n    limitTest,\n    testValueName,\n    defaultLimit,\n    maximumLimit\n  );\n\n  await t.testDeviceWithSpecificLimits(\n    requestedLimit,\n    testValue,\n    async ({ device, testValue, shouldError }) => {\n      const pipelineDescriptor = getPipelineDescriptor(device, testValue);\n\n      await t.testCreateRenderPipeline(pipelineDescriptor, async, shouldError);\n    }\n  );\n});\n\ng.test('validate').\ndesc(`Test that ${limit} is a multiple of 4 bytes`).\nfn((t) => {\n  const { defaultLimit, adapterLimit } = t;\n  t.expect(defaultLimit % 4 === 0);\n  t.expect(adapterLimit % 4 === 0);\n});"],"mappings":"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","ignoreList":[]}