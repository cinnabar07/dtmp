{"version":3,"file":"ref.spec.js","names":["description","makeTestGroup","ShaderValidationTest","g","kTypes","test","desc","params","u","combine","fn","t","ty","type","ref","code","expectCompileResult","view"],"sources":["../../../../../src/webgpu/shader/validation/types/ref.spec.ts"],"sourcesContent":["/**\n* AUTO-GENERATED - DO NOT EDIT. Source: https://github.com/gpuweb/cts\n**/export const description = `\nValidation tests for ref types\n`;import { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kTypes = ['bool', 'i32', 'f32', 'vec2i', 'mat2x2f', 'array<i32, 4>', 'S'];\n\ng.test('not_typeable_var').\ndesc('Test that `ref` cannot be typed in a shader as an explicit var decl type.').\nparams((u) => u.combine('type', kTypes).combine('ref', [false, true])).\nfn((t) => {\n  let ty = t.params.type;\n  if (t.params.ref) {\n    ty = `ref<private, ${ty}>`;\n  }\n  const code = `\n    struct S { a : u32 }\n    var<private> foo : ${ty};`;\n  t.expectCompileResult(!t.params.ref, code);\n});\n\ng.test('not_typeable_let').\ndesc('Test that `ref` cannot be typed in a shader as a let decl type.').\nparams((u) => u.combine('type', kTypes).combine('view', ['ptr', 'ref'])).\nfn((t) => {\n  const code = `\n      struct S { a : u32 }\n      fn foo() {\n        var a : ${t.params.type};\n        let b : ${t.params.view}<function, ${t.params.type}> = &a;\n      }`;\n  t.expectCompileResult(t.params.view === 'ptr', code);\n});\n\ng.test('not_typeable_param').\ndesc('Test that `ref` cannot be typed in a shader as a function parameter type.').\nparams((u) => u.combine('type', kTypes).combine('view', ['ptr', 'ref'])).\nfn((t) => {\n  const code = `\n    struct S { a : u32 }\n    fn foo(a : ${t.params.view}<private, ${t.params.type}>) {}`;\n  t.expectCompileResult(t.params.view === 'ptr', code);\n});\n\ng.test('not_typeable_alias').\ndesc('Test that `ref` cannot be typed in a shader as an alias type.').\nparams((u) => u.combine('type', kTypes).combine('view', ['ptr', 'ref'])).\nfn((t) => {\n  const code = `\n    struct S { a : u32 }\n    alias a = ${t.params.view}<private, ${t.params.type}>;`;\n  t.expectCompileResult(t.params.view === 'ptr', code);\n});"],"mappings":"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","ignoreList":[]}