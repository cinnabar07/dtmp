{"version":3,"file":"canvas_image_rendering.html.js","names":["runRefTest","t","device","presentationFormat","navigator","gpu","getPreferredCanvasFormat","module","createShaderModule","code","pipeline","createRenderPipeline","layout","vertex","entryPoint","fragment","targets","format","draw","selector","alphaMode","canvas","document","querySelector","context","getContext","configure","encoder","globalThis","_TRAMPOLINE_","createCommandEncoder","pass","beginRenderPass","colorAttachments","view","getCurrentTexture","createView","clearValue","loadOp","storeOp","setPipeline","end","queue","submit","finish"],"sources":["../../../../src/webgpu/web_platform/reftests/canvas_image_rendering.html.ts"],"sourcesContent":["/**\n* AUTO-GENERATED - DO NOT EDIT. Source: https://github.com/gpuweb/cts\n**/import { runRefTest } from './gpu_ref_test.js';runRefTest((t) => {\n  const device = t.device;\n  const presentationFormat = navigator.gpu.getPreferredCanvasFormat();\n\n  const module = device.createShaderModule({\n    code: `\n      @vertex fn vs(\n        @builtin(vertex_index) VertexIndex : u32\n      ) -> @builtin(position) vec4<f32> {\n        var pos = array<vec2<f32>, 3>(\n        vec2(-1.0, 3.0),\n        vec2(-1.0,-1.0),\n        vec2( 3.0,-1.0)\n        );\n\n        return vec4(pos[VertexIndex], 0.0, 1.0);\n      }\n\n      @fragment fn fs(\n         @builtin(position) Pos : vec4<f32>\n      ) -> @location(0) vec4<f32> {\n        let black = vec4f(0, 0, 0, 1);\n        let white = vec4f(1, 1, 1, 1);\n        let iPos = vec4u(Pos);\n        let check = (iPos.x + iPos.y) & 1;\n        return mix(black, white, f32(check));\n      }\n    `\n  });\n\n  const pipeline = device.createRenderPipeline({\n    layout: 'auto',\n    vertex: {\n      module,\n      entryPoint: 'vs'\n    },\n    fragment: {\n      module,\n      entryPoint: 'fs',\n      targets: [{ format: presentationFormat }]\n    }\n  });\n\n  function draw(selector, alphaMode) {\n    const canvas = document.querySelector(selector);\n    const context = canvas.getContext('webgpu');\n    context.configure({\n      device,\n      format: presentationFormat,\n      alphaMode\n    });\n\n    const encoder = globalThis._TRAMPOLINE_(\"createCommandEncoder\", device, device.createCommandEncoder, [], () => device.createCommandEncoder());\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n      {\n        view: context.getCurrentTexture().createView(),\n        clearValue: [0.0, 0.0, 0.0, 0.0],\n        loadOp: 'clear',\n        storeOp: 'store'\n      }]\n\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n\n    globalThis._TRAMPOLINE_(\"submit\", device, device.queue.submit, [[encoder.finish()]], () => device.queue.submit([encoder.finish()]));\n  }\n\n  draw('#elem1', 'premultiplied');\n  draw('#elem2', 'premultiplied');\n  draw('#elem3', 'premultiplied');\n  draw('#elem4', 'opaque');\n  draw('#elem5', 'opaque');\n  draw('#elem6', 'opaque');\n});"],"mappings":"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","ignoreList":[]}